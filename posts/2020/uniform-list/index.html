<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="icon" type="image/png" href="/theme/avatar.png" />
        <link rel="stylesheet" href="/theme/css/style.min.css?dbfa8bf4">
        <link rel="alternate" type="application/rss+xml" href="/rss.xml">
        <title>nitori.org :: Problem: Finding a list subset with uniform distribution</title>
    </head>
    <body>
        <div id="inner-body">
            <header>
                <a href="/"><img class="rotater" src="/theme/little-flower.svg" width="40" alt="A flower" /></a>
                <nav>
                    <a href="/">Home</a>
                    <a href="/pages/projects/">Projects</a>
                    <a href="/pages/contact/">Contact</a>
                </nav>
            </header>

            <main>
<div class="body-block">
<p class="article-byline">
    <time>2020-10-16</time>
    <br />
    <time>Updated: 2020-10-18</time>
    <br />
    <span class="author">By Jennifer Wilcox</span>
</p>
<h1>Problem: Finding a list subset with uniform distribution</h1>

<div class="section" id="context">
<h2>Context</h2>
<p>Continuous integration will often produce a lot of builds for a product under
active development. If our build artifacts are large (perhaps in the GB range)
we will need to start pruning old builds.</p>
<p>A simple solution for pruning builds is just to discard builds older than a
certain date. However, it can sometimes be useful to preserve a few olds
builds <a class="footnote-reference" href="#footnote-1" id="footnote-reference-1">[1]</a>. This can be especially useful when trying to track down an obscure bug.
If we have a few old builds around, we can more effectively <a class="reference external" href="https://git-scm.com/docs/git-bisect">bisect</a> commits to
try and find the culprit.</p>
<p>So we might want to have an aggressive pruning policy for maybe the last two
weeks or so. But we also want to preserve 15 builds from the last year. And
ideally we'd like those 15 builds to be spaced apart in time <a class="footnote-reference" href="#footnote-2" id="footnote-reference-2">[2]</a> as far as
possible.</p>
<p>Since we're implementing continuous integration, our builds could happen at any
time. Thus the problem presents itself: if we have a list of all the builds in
the last year, how do we choose which builds should be pruned and which should
be kept?</p>
</div>
<div class="section" id="formalized-problem">
<h2>Formalized Problem</h2>
<p>Given a sorted list <span class="math">\(A\)</span> of size <span class="math">\(n\)</span>, find the sorted sub-list
<span class="math">\(B\)</span> with size <span class="math">\(m\)</span> where <span class="math">\(2 &lt; m &lt; n\)</span> such that the items of
sub-list <span class="math">\(B\)</span> are &quot;uniformly spaced&quot; and <span class="math">\(A_0 = B_0,
A_{n-1}=B_{n-1}\)</span> (i.e. preserving the first and last elements of <span class="math">\(A\)</span>).</p>
<p>Formally, by &quot;uniformly spaced&quot; I mean that this metric should be minimized:</p>
<div class="math">
\begin{equation*}
\sum_{i=1}^{m-2} |(B_{i+1} - B_i) - (B_i - B_{i-1})|
\end{equation*}
</div>
<p>A few test examples:</p>
<div class="math">
\begin{equation*}
\begin{aligned}
A = [1, 2, 3]; m=2 \quad &amp;\Rightarrow \quad B = [1, 3] \\
A = [1, 4.5, 4.6, 5, 5.1, 5.2, 6, 9]; m=3 \quad &amp;\Rightarrow \quad B = [1, 5, 9] \\
A = [1, 2, 3, 4, 5, 6, 7]; m=4 \quad &amp;\Rightarrow \quad B = [1, 3, 5, 7]
\end{aligned}
\end{equation*}
</div>
<p>In each of these examples, the metric given above is <span class="math">\(0\)</span></p>
<table class="docutils footnote" frame="void" id="footnote-1" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#footnote-reference-1">[1]</a></td><td>Hermetically reproducible builds is another possible solution</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="footnote-2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#footnote-reference-2">[2]</a></td><td>One could also argue that it's better to be uniformly spaced between
build numbers, as it would preserve more builds from a period of more active
development, making bisection more efficient</td></tr>
</tbody>
</table>
</div>
<script type='text/javascript'>if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
</div>
            </main>
        </div>
    </body>
</html>